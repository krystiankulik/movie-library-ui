(this["webpackJsonpmovie-ui"]=this["webpackJsonpmovie-ui"]||[]).push([[0],{101:function(e,n,t){e.exports={addTooltip:"ActorsInput_addTooltip__KrXN5",chipContainer:"ActorsInput_chipContainer__2RU2i",chipWrapper:"ActorsInput_chipWrapper__2RzPi"}},107:function(e,n,t){e.exports={appContainer:"App_appContainer__h_gBU"}},115:function(e,n,t){e.exports={currentUsername:"Header_currentUsername__3h585",homeButton:"Header_homeButton__2IoHw"}},145:function(e,n,t){e.exports={errorMessage:"ErrorMessage_errorMessage__cx3Aj"}},146:function(e,n,t){e.exports={container:"ClientFaultPage_container__3KkNu"}},151:function(e,n,t){e.exports={durationInput:"DurationInput_durationInput__2NwsE"}},176:function(e,n,t){},197:function(e,n,t){"use strict";t.r(n);var a=t(2),r=t(0),i=t.n(r),o=t(20),c=t.n(o),s=(t(176),t(107)),u=t.n(s),l=t(16),d=t(7),j=t(63),v=t(137),b=t(84),m=t.n(b),O=t(157),h=t(247),f=t(22),p=t(48),x=t(23);function g(){var e=Object(x.a)(["\n    query GetAllMovies {\n        getAllMovies {\n            id,\n            name,\n            releaseDate,\n            duration,\n            actors,\n            averageNote,\n        }\n    }\n"]);return g=function(){return e},e}var M=Object(l.gql)(g());function C(){var e=Object(x.a)(["\n    query currentUSer {\n        currentUser {\n            username\n        }\n    }\n"]);return C=function(){return e},e}var N=Object(l.gql)(C()),_=function(){return Object(l.useQuery)(N)},I=t(40),D=t.n(I),w=function(e){return String(e).length<=1?"0"+String(e):String(e)},S=function(e){return"".concat(Math.floor(e/60),":").concat(w(e%60))},y=function(e){return{id:e.id,name:e.name,releaseDate:D()(e.releaseDate),duration:S(e.duration),actors:e.actors,username:e.username,averageNote:e.averageNote}},k=function(e){return e.format("YYYY-MM-DD")},A=function(e){return function(n){n.target.value.length<100&&e(n.target.value)}},B=t(256),$=function(e){return Object(a.jsx)(B.a,{name:"rating-read-only",value:e.value,precision:.1,readOnly:!0})},P=t(246),U="sortingColumn",F="sortingDirection",q=[{field:"name",headerName:"Name",width:150},{field:"releaseDate",headerName:"Release Date",width:150,type:"date",valueFormatter:function(e){return k(D()(e.value))}},{field:"duration",headerName:"Duration",type:"number",width:150},{field:"actors",headerName:"Actors",sortable:!1,width:150,cellClassName:"actorsCellStyle",renderCell:function(e){return Object(a.jsx)("div",{className:m.a.actorsCell,children:e.value.join(", ")})}},{field:"averageNote",headerName:"Average Note",renderCell:function(e){return Object(a.jsx)($,{value:Number(e.value)})},sortable:!0,type:"number",width:150}],R=function(e,n){return n?e.map((function(e){return Object(j.a)(Object(j.a)({},e),{},{flex:1,cellClassName:"cellStyle"})})):e},E=Object(O.a)({root:{backgroundColor:"white","& .cellStyle":{cursor:"pointer"},"& .actorsCellStyle":{whiteSpace:"pre-wrap",overflow:"auto"}}}),H=function(){var e,n=E(),t=Object(l.useQuery)(M),i=t.data,o=t.error,c=Object(h.a)("(min-width:60rem)"),s=_(),u=Object(f.f)(),j=function(){var e=Object(P.a)([U,F]),n=Object(d.a)(e,3),t=n[0],a=n[1],r=n[2];return[t.sortingColumn,t.sortingDirection,function(e,n){a(U,e),a(F,n)},function(){r(U),r(F)}]}(),b=Object(d.a)(j,4),O=b[0],x=b[1],g=b[2],C=b[3],N=Object(r.useState)([]),I=Object(d.a)(N,2),D=I[0],w=I[1];Object(r.useEffect)((function(){O&&x&&w([{field:O,sort:x}])}),[O,x]);if(o)return Object(a.jsx)("p",{children:"Error :("});return Object(a.jsxs)("div",{className:m.a.dashboardContainer,children:[Object(a.jsx)("h1",{children:"Movie Library"}),Object(a.jsx)("div",{children:function(){var e;return(null===(e=s.data)||void 0===e?void 0:e.currentUser.username)?null:Object(a.jsxs)("div",{className:m.a.infoDialog,children:[Object(a.jsx)(p.b,{to:"/sign-in",children:"Sing In"})," to share and rate movies!"]})}()}),Object(a.jsx)("div",{className:m.a.dataGridContainer,children:Object(a.jsx)(v.a,{rows:(null!==(e=null===i||void 0===i?void 0:i.getAllMovies)&&void 0!==e?e:[]).map((function(e){return y(e)})),columns:R(q,c),pageSize:10,onSelectionChange:function(e){return n=String(e.rowIds[0]),void u.push("/movies/"+n);var n},className:n.root,sortModel:D,onSortModelChange:function(e){if(e.sortModel!==D){w(e.sortModel);var n=e.sortModel[0];(null===n||void 0===n?void 0:n.sort)?g(n.field,n.sort):C()}},rowHeight:80})})]})},L=t(37),T=t.n(L),z=t(254),G=t(248),Q=t(28),W=t.n(Q),Y="authToken",J=function(){var e=Object(P.a)([Y]),n=Object(d.a)(e,3),t=n[0],a=n[1],r=n[2];return[t.authToken,function(e){return a(Y,e)},function(){return r(Y)}]};function Z(){var e=Object(x.a)(["\n    mutation login($username: String!, $password: String!) {\n        login( username: $username, password: $password ) {\n            token,\n            user {\n                id,\n                username\n            }\n        }\n    }\n"]);return Z=function(){return e},e}var K=W()(Z()),V=function(){var e=J(),n=Object(d.a)(e,3),t=n[1],a=n[2],r=Object(l.useMutation)(K,{onCompleted:function(e){t(e.login.token)}}),i=Object(d.a)(r,2),o=i[0];return[function(e,n){return a(),o({variables:{username:e,password:n}})},i[1]]},X=t(145),ee=t.n(X),ne=function(e){return Object(a.jsx)(a.Fragment,{children:e.errorMessages.map((function(e,n){return Object(a.jsx)("div",{className:ee.a.errorMessage,children:e},n)}))})},te=function(){var e=Object(r.useState)(""),n=Object(d.a)(e,2),t=n[0],i=n[1],o=Object(r.useState)(""),c=Object(d.a)(o,2),s=c[0],u=c[1],l=Object(r.useState)([]),j=Object(d.a)(l,2),v=j[0],b=j[1],m=Object(f.f)(),O=V(),h=Object(d.a)(O,1)[0];return Object(a.jsx)("div",{className:T.a.mainContainer,children:Object(a.jsxs)("div",{className:T.a.formContainer,children:[Object(a.jsxs)("div",{className:T.a.registerHint,children:["Don't have account yet? ",Object(a.jsx)(p.b,{to:"/register",children:"Register"}),"."]}),Object(a.jsx)("h1",{children:"Sign in"}),Object(a.jsx)(ne,{errorMessages:v}),Object(a.jsx)("div",{className:T.a.formItem,children:Object(a.jsx)(z.a,{id:"username",label:"Username",value:t,onChange:A(i)})}),Object(a.jsx)("div",{className:T.a.formItem,children:Object(a.jsx)(z.a,{id:"password",label:"Password",type:"password",value:s,onChange:A(u)})}),Object(a.jsx)("div",{className:T.a.formItem,children:Object(a.jsx)(G.a,{variant:"outlined",color:"primary",onClick:function(){var e=[];t.length<3&&e.push("Username should be at least 3 characters long."),s.length<3&&e.push("Password should be at least 3 characters long."),e.length>0?b(e):h(t,s).then((function(){return m.push("/")})).catch((function(e){return b([e.message])}))},children:"Sign In"})})]})})};function ae(){var e=Object(x.a)(["\n    mutation register($username: String!, $password: String!) {\n        register( username: $username, password: $password ) {\n            id,\n            username\n        }\n    }\n"]);return ae=function(){return e},e}var re=W()(ae()),ie=function(){var e=r.useState(""),n=Object(d.a)(e,2),t=n[0],i=n[1],o=r.useState(""),c=Object(d.a)(o,2),s=c[0],u=c[1],j=r.useState(""),v=Object(d.a)(j,2),b=v[0],m=v[1],O=function(){var e=Object(l.useMutation)(re),n=Object(d.a)(e,2),t=n[0];return[function(e,n){return t({variables:{username:e,password:n}})},n[1]]}(),h=Object(d.a)(O,1)[0],p=V(),x=Object(d.a)(p,1)[0],g=Object(r.useState)([]),M=Object(d.a)(g,2),C=M[0],N=M[1],_=Object(f.f)();return Object(a.jsx)("div",{className:T.a.mainContainer,children:Object(a.jsxs)("div",{className:T.a.formContainer,children:[Object(a.jsx)("h1",{children:"Register"}),Object(a.jsx)(ne,{errorMessages:C}),Object(a.jsx)("div",{className:T.a.formItem,children:Object(a.jsx)(z.a,{id:"username",label:"Username",value:t,onChange:A(i)})}),Object(a.jsx)("div",{className:T.a.formItem,children:Object(a.jsx)(z.a,{id:"password",label:"Password",type:"password",value:s,onChange:A(u)})}),Object(a.jsx)("div",{className:T.a.formItem,children:Object(a.jsx)(z.a,{id:"passwordConfirm",label:"Password Confirm",type:"password",value:b,onChange:A(m)})}),Object(a.jsx)("div",{className:T.a.formItem,children:Object(a.jsx)(G.a,{variant:"outlined",color:"primary",onClick:function(){var e=[];t.length<3&&e.push("Username should be at least 3 characters long."),s.length<3&&e.push("Password should be at least 3 characters long."),s!==b&&e.push("Passwords are not equal"),e.length>0?N(e):h(t,s).then((function(){x(t,s).then((function(){return _.push("/")})).catch((function(e){return N([e.message])}))})).catch((function(e){return N([e.message])}))},children:"Register"})})]})})},oe=t(146),ce=t.n(oe),se=function(e){return Object(a.jsx)("div",{className:ce.a.container,children:Object(a.jsx)("h1",{children:e.text})})},ue=t(147),le=t(4),de=new l.HttpLink({uri:"http://46.101.123.165:3001/v1/graphql"}),je=function(e){return Object(l.split)((function(e){var n=e.query,t=Object(le.p)(n);return"OperationDefinition"===t.kind&&"subscription"===t.operation}),function(e){return new ue.a({uri:"ws://46.101.123.165:3001/graphql",options:{reconnect:!0},connectionParams:{authToken:e}})}(e),ve(e).concat(de))},ve=function(e){return new l.ApolloLink((function(n,t){return e&&n.setContext({headers:{authorization:"Bearer ".concat(e)}}),t(n)}))},be=new l.InMemoryCache({typePolicies:{Movie:{fields:{actors:{merge:function(e,n){return n}}}}}}),me=t(258),Oe=t(243),he=t(249),fe=t(242),pe=t(114),xe=t.n(pe),ge=t(149),Me=t(115),Ce=t.n(Me),Ne=t(150),_e=t.n(Ne),Ie=Object(O.a)((function(e){return Object(me.a)({space:{flexGrow:1},header:{backgroundColor:"#7dc7cb"},menuButton:{marginRight:e.spacing(2)}})})),De=function(){var e=Ie(),n=_(),t=function(){var e=J(),n=Object(d.a)(e,3)[2],t=Object(l.useApolloClient)();return Object(ge.a)(xe.a.mark((function e(){return xe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.clearStore();case 2:n();case 3:case"end":return e.stop()}}),e)})))}(),r=Object(f.f)(),i=function(){return r.push("/sign-in")},o=function(){return r.push("/register")},c=function(){return r.push("/add-movie")},s=function(){t(),r.push("/")};return Object(a.jsx)(he.a,{position:"static",className:e.header,children:Object(a.jsxs)(fe.a,{children:[Object(a.jsx)("div",{className:Ce.a.homeButton,children:Object(a.jsx)(_e.a,{onClick:function(){return r.push("/")}})}),Object(a.jsx)("div",{className:e.space}),n.data?Object(a.jsx)("div",{className:Ce.a.currentUsername,children:Object(a.jsx)(Oe.a,{variant:"h6",children:n.data.currentUser.username})}):null,n.data?null:Object(a.jsx)(G.a,{color:"inherit",onClick:i,children:"Sing In"}),n.data?null:Object(a.jsx)(G.a,{color:"inherit",onClick:o,children:"Register"}),n.data?Object(a.jsx)(G.a,{color:"inherit",onClick:c,children:"Add movie"}):null,n.data?Object(a.jsx)(G.a,{color:"inherit",onClick:s,children:"Log out"}):null]})})},we=t(26),Se=t.n(we),ye=t(34);function ke(){var e=Object(x.a)(["\n                                fragment NewMovie on Movie {\n                                    id,\n                                    name,\n                                    releaseDate,\n                                    duration,\n                                    actors,\n                                    username,\n                                    averageNote,\n                                    ratings {\n                                        username,\n                                        note,\n                                        comment\n                                    },\n                                }\n                            "]);return ke=function(){return e},e}function Ae(){var e=Object(x.a)(["\n    mutation addMovie($input: AddMovieInput!) {\n        addMovie(input: $input) {\n            id,\n            name,\n            releaseDate,\n            duration,\n            username,\n            actors,\n            averageNote\n            ratings {\n                username,\n                note,\n                comment\n            }\n        }\n    }\n"]);return Ae=function(){return e},e}var Be=W()(Ae()),$e=t(257),Pe=t(151),Ue=t.n(Pe),Fe=function(e){return Math.floor(e/60)},qe=function(e){return e%60},Re=function(e,n){return 60*e+n},Ee=i.a.memo((function(e){var n=Object(r.useState)(Fe(e.duration)),t=Object(d.a)(n,2),i=t[0],o=t[1],c=Object(r.useState)(qe(e.duration)),s=Object(d.a)(c,2),u=s[0],l=s[1];return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{children:Object(a.jsx)($e.a,{children:"Duration"})}),Object(a.jsxs)("div",{className:Ue.a.durationInput,children:[Object(a.jsx)(z.a,{id:"filled-number",label:"Hours",type:"number",value:i,onChange:function(n){var t=Number(n.target.value);t>=0&&(o(t),e.setDuration(Re(t,u)))},InputLabelProps:{shrink:!0},variant:"filled"}),Object(a.jsx)(z.a,{id:"filled-number",label:"Minutes",type:"number",value:u,onChange:function(n){var t=Number(n.target.value);if(t>=60){var a=i+Fe(t),r=qe(t);o(a),l(r),e.setDuration(Re(a,r))}else t>=0&&(l(t),e.setDuration(Re(i,t)))},InputLabelProps:{shrink:!0},variant:"filled"})]})]})})),He=t(259),Le=t(205),Te=t(250),ze=t(152),Ge=t.n(ze),Qe=t(101),We=t.n(Qe),Ye=Object(r.memo)((function(e){var n=Object(r.useState)(""),t=Object(d.a)(n,2),i=t[0],o=t[1];return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{children:Object(a.jsx)($e.a,{children:"Actors"})}),Object(a.jsx)("div",{className:We.a.chipContainer,children:e.actors.map((function(n){return Object(a.jsx)("div",{className:We.a.chipWrapper,children:Object(a.jsx)(He.a,{label:n,onDelete:function(){return t=n,void e.setActors((function(e){return e.filter((function(e){return e!==t}))}));var t}})},n)}))}),Object(a.jsxs)("div",{children:[Object(a.jsx)(z.a,{id:"newActor",value:i,onChange:function(e){o(e.target.value)},InputLabelProps:{shrink:!0}}),Object(a.jsx)("div",{className:We.a.addTooltip,children:Object(a.jsx)(Le.a,{title:"Add","aria-label":"add",onClick:function(){i.length>0&&(e.actors.includes(i)||e.setActors((function(e){return e.concat(i)})),o(""))},children:Object(a.jsx)(Te.a,{color:"default",children:Object(a.jsx)(Ge.a,{})})})})]})]})})),Je=function(e){return Object(a.jsx)(z.a,{id:"date",label:"Release Date",type:"date",value:k(e.date),onChange:function(n){e.setDate(D()(n.target.value))},InputLabelProps:{shrink:!0}})},Ze=function(e){return Object(a.jsx)(z.a,{id:"name",label:"Name",value:e.name,onChange:A(e.setName)})},Ke=function(){var e=Object(r.useState)(""),n=Object(d.a)(e,2),t=n[0],i=n[1],o=Object(r.useState)(D()()),c=Object(d.a)(o,2),s=c[0],u=c[1],j=Object(r.useState)(90),v=Object(d.a)(j,2),b=v[0],m=v[1],O=Object(r.useState)([]),h=Object(d.a)(O,2),p=h[0],x=h[1],g=Object(r.useState)([]),M=Object(d.a)(g,2),C=M[0],N=M[1],_=function(){var e=Object(l.useMutation)(Be,{update:function(e,n){e.modify({fields:{getAllMovies:function(){var t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=e.writeFragment({data:null===(t=n.data)||void 0===t?void 0:t.addMovie,fragment:W()(ke())});return[].concat(Object(ye.a)(a),[r])}}})}}),n=Object(d.a)(e,2),t=n[0];return[function(e,n,a,r){return t({variables:{input:{name:e,releaseDate:k(n),duration:a,actors:r}}})},n[1]]}(),I=Object(d.a)(_,1)[0],w=Object(f.f)(),S=Object(r.useCallback)((function(e){return x(e)}),[]),y=Object(r.useCallback)((function(e){return m(e)}),[]);return Object(a.jsx)("div",{className:Se.a.mainContainer,children:Object(a.jsxs)("div",{className:Se.a.formContainer,children:[Object(a.jsx)("h1",{children:"Add new movie"}),Object(a.jsx)(ne,{errorMessages:C}),Object(a.jsx)("div",{className:Se.a.formItem,children:Object(a.jsx)(Ze,{name:t,setName:i})}),Object(a.jsx)("div",{className:Se.a.formItem,children:Object(a.jsx)(Je,{date:s,setDate:u})}),Object(a.jsx)("div",{className:Se.a.formItem,children:Object(a.jsx)("div",{children:Object(a.jsx)(Ee,{duration:b,setDuration:y})})}),Object(a.jsx)("div",{className:Se.a.formItem,children:Object(a.jsx)(Ye,{actors:p,setActors:S})}),Object(a.jsx)("div",{className:Se.a.formItem,children:Object(a.jsx)(G.a,{variant:"outlined",color:"primary",onClick:function(){var e=[];0===t.length&&e.push("Movie name should not be empty."),b<=0&&e.push("Movie duration should be positive."),s.isValid()||e.push("Movie release date is not correct."),e.length>0?N(e):I(t,s,b,p).then((function(){w.push("/")})).catch((function(e){return N([e.message])}))},children:"Add New Movie"})})]})})};function Ve(){var e=Object(x.a)(["\n    subscription OnRatingAdded($movieId: String!) {\n        ratingAdded(movieId: $movieId){\n            comment,\n            username,\n            note\n        }\n    }\n"]);return Ve=function(){return e},e}function Xe(){var e=Object(x.a)(["\n    query GetMovie($movieId: String!) {\n        getMovie(movieId: $movieId) {\n            id,\n            name,\n            releaseDate,\n            duration,\n            actors,\n            username,\n            averageNote,\n            ratings {\n                username,\n                note,\n                comment\n            }\n        }\n    }\n"]);return Xe=function(){return e},e}var en=Object(l.gql)(Xe()),nn=Object(l.gql)(Ve()),tn=function(e){var n=Object(l.useQuery)(en,{variables:{movieId:e}}),t=n.loading,a=n.data,r=n.subscribeToMore;return[t,a,function(){return r({document:nn,variables:{movieId:e},updateQuery:function(e,n){var t,a=n.subscriptionData;if(!a.data)return e;var r=a.data.ratingAdded;return{getMovie:Object(j.a)(Object(j.a)({},e.getMovie),{},{averageNote:r.averageNote,ratings:[].concat(Object(ye.a)((null===e||void 0===e||null===(t=e.getMovie)||void 0===t?void 0:t.ratings)||[]),[Object(j.a)({},r)])})}}})}]},an=t(50),rn=t.n(an);function on(){var e=Object(x.a)(["\n    mutation addMovie($movieId: String! $note: Int!, $comment: String) {\n        rateMovie(movieId: $movieId, note: $note, comment: $comment) {\n            id,\n            averageNote,\n            ratings {\n                username,\n                note,\n                comment\n            }\n        }\n    }\n"]);return on=function(){return e},e}var cn=Object(l.gql)(on());function sn(){var e=Object(x.a)(["\n    mutation removeMovie($movieId: String!) {\n        removeMovie(movieId: $movieId) {\n            id\n        }\n    }\n"]);return sn=function(){return e},e}var un=W()(sn()),ln=function(e){var n,t,i=tn(e.selectedMovieId),o=Object(d.a)(i,3),c=o[0],s=o[1],u=o[2],j=Object(r.useState)(""),v=Object(d.a)(j,2),b=v[0],m=v[1],O=Object(r.useState)(2),h=Object(d.a)(O,2),p=h[0],x=h[1],g=function(){var e=Object(l.useMutation)(cn),n=Object(d.a)(e,2),t=n[0];return[function(e,n,a){return t({variables:{movieId:e,note:n,comment:a}})},n[1]]}(),C=Object(d.a)(g,1)[0],N=function(){var e=Object(l.useMutation)(un,{update:function(e,n){var t,a=e.readQuery({query:M}),r=(null!==(t=null===a||void 0===a?void 0:a.getAllMovies)&&void 0!==t?t:[]).filter((function(e){var t;return e.id!==(null===(t=n.data)||void 0===t?void 0:t.removeMovie.id)}));e.modify({fields:{getAllMovies:function(){return r}}})}}),n=Object(d.a)(e,2),t=n[0];return[function(e){return t({variables:{movieId:e}})},n[1]]}(),I=Object(d.a)(N,1)[0],w=_(),S=Object(f.f)();if(Object(r.useEffect)((function(){var e=u();return function(){return e()}}),[w]),!(null===s||void 0===s?void 0:s.getMovie)&&!c)return Object(a.jsx)(se,{text:"404 Not found"});var A=(null===s||void 0===s?void 0:s.getMovie)?y(null===s||void 0===s?void 0:s.getMovie):null,P=function(){var e;C(null!==(e=null===A||void 0===A?void 0:A.id)&&void 0!==e?e:"",Number(p),b).catch((function(e){return console.error(e.message)}))},U=function(){S.push("/edit-movie/"+(null===A||void 0===A?void 0:A.id))},F=function(){var e;I(null!==(e=null===A||void 0===A?void 0:A.id)&&void 0!==e?e:"").then((function(){return S.push("/")})).catch((function(e){return console.error(e.message)}))};return Object(a.jsxs)("div",{className:rn.a.mainContainer,children:[Object(a.jsx)("h2",{children:"Movie Details"}),Object(a.jsxs)("div",{className:rn.a.detailsContainer,children:[Object(a.jsxs)("div",{className:rn.a.detailsInfoContainer,children:[Object(a.jsx)("div",{children:Object(a.jsx)("b",{children:"Name"})}),Object(a.jsx)("div",{children:null===A||void 0===A?void 0:A.name}),Object(a.jsx)("div",{children:Object(a.jsx)("b",{children:"Release Date"})}),Object(a.jsx)("div",{children:(null===A||void 0===A?void 0:A.releaseDate)?k(D()(null===A||void 0===A?void 0:A.releaseDate)):""}),Object(a.jsx)("div",{children:Object(a.jsx)("b",{children:"Duration"})}),Object(a.jsx)("div",{children:null===A||void 0===A?void 0:A.duration}),Object(a.jsx)("div",{children:Object(a.jsx)("b",{children:"Actors"})}),Object(a.jsx)("div",{children:null===A||void 0===A?void 0:A.actors.join(", ")}),Object(a.jsx)("div",{children:Object(a.jsx)("b",{children:"Created by"})}),Object(a.jsx)("div",{children:null===A||void 0===A?void 0:A.username}),Object(a.jsx)("div",{children:Object(a.jsx)("b",{children:"Average Note"})}),Object(a.jsx)("div",{children:Object(a.jsx)($,{value:null!==(n=null===A||void 0===A?void 0:A.averageNote)&&void 0!==n?n:0})})]}),Object(a.jsxs)("div",{className:rn.a.actionButtons,children:[w.data?Object(a.jsx)("div",{className:rn.a.actionButton,children:Object(a.jsx)(G.a,{variant:"outlined",color:"default",size:"small",onClick:U,children:"Edit"})}):null,w.data?Object(a.jsx)("div",{className:rn.a.actionButton,children:Object(a.jsx)(G.a,{variant:"outlined",color:"secondary",size:"small",onClick:F,children:"Delete"})}):null]})]}),Object(a.jsx)("h3",{children:"Comments"}),function(){var e,n;return(null!==(e=null===s||void 0===s||null===(n=s.getMovie)||void 0===n?void 0:n.ratings)&&void 0!==e?e:[]).filter((function(e){var n;return e.username===(null===(n=w.data)||void 0===n?void 0:n.currentUser.username)})).length>0||!w.data?null:Object(a.jsxs)("div",{className:rn.a.rateInput,children:[Object(a.jsx)("h5",{children:"Add your rating:"}),Object(a.jsx)("div",{className:rn.a.inputFormItem,children:Object(a.jsx)(B.a,{name:"userNote",value:p,precision:1,onChange:function(e,n){x(n)}})}),Object(a.jsx)("div",{className:rn.a.inputFormItem,children:Object(a.jsx)(z.a,{id:"comment-input",label:"Comment",multiline:!0,rowsMax:4,value:b,onChange:function(e){return m(e.target.value)}})}),Object(a.jsx)("div",{children:Object(a.jsx)(G.a,{variant:"outlined",color:"primary",size:"medium",onClick:P,children:"Rate"})})]})}(),Object(a.jsx)("div",{className:rn.a.comments,children:((null===s||void 0===s||null===(t=s.getMovie)||void 0===t?void 0:t.ratings)||[]).map((function(e){return n=e,Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{children:Object(a.jsx)("h6",{children:n.username})}),Object(a.jsx)("div",{children:Object(a.jsx)($,{value:n.note})}),Object(a.jsx)("div",{children:n.comment})]},n.username);var n}))})]})};function dn(){var e=Object(x.a)(["\n    mutation editMovie($input: EditMovieInput!) {\n        editMovie(input: $input) {\n            id,\n            name,\n            releaseDate,\n            duration,\n            username,\n            actors,\n            averageNote\n            ratings {\n                username,\n                note,\n                comment\n            }\n        }\n    }\n"]);return dn=function(){return e},e}var jn=W()(dn()),vn=function(e){var n=tn(e.selectedMovieId),t=Object(d.a)(n,2)[1],i=void 0===t,o=Object(r.useState)(""),c=Object(d.a)(o,2),s=c[0],u=c[1],j=Object(r.useState)(D()()),v=Object(d.a)(j,2),b=v[0],m=v[1],O=Object(r.useState)(),h=Object(d.a)(O,2),p=h[0],x=h[1],g=Object(r.useState)([]),M=Object(d.a)(g,2),C=M[0],N=M[1],_=function(){var e=Object(l.useMutation)(jn),n=Object(d.a)(e,2),t=n[0];return[function(e,n,a,r,i){return t({variables:{input:{movieId:e,name:n,releaseDate:k(a),duration:r,actors:i}}})},n[1]]}(),I=Object(d.a)(_,1)[0],w=Object(f.f)(),S=Object(r.useState)([]),y=Object(d.a)(S,2),A=y[0],B=y[1],$=Object(r.useCallback)((function(e){return N(e)}),[]),P=Object(r.useCallback)((function(e){return x(e)}),[]);Object(r.useEffect)((function(){var e=null===t||void 0===t?void 0:t.getMovie;e&&!i&&(u(e.name),x(e.duration),m(D()(e.releaseDate)),N(e.actors))}),[null===t||void 0===t?void 0:t.getMovie,i]);var U=function(){var e;return w.push("/movies/"+(null===t||void 0===t||null===(e=t.getMovie)||void 0===e?void 0:e.id))};return Object(a.jsx)("div",{className:Se.a.mainContainer,children:Object(a.jsxs)("div",{className:Se.a.formContainer,children:[Object(a.jsx)("h1",{children:"Edit movie"}),Object(a.jsx)(ne,{errorMessages:A}),Object(a.jsx)("div",{className:Se.a.formItem,children:Object(a.jsx)(Ze,{name:s,setName:u})}),Object(a.jsx)("div",{className:Se.a.formItem,children:Object(a.jsx)(Je,{date:b,setDate:m})}),Object(a.jsx)("div",{className:Se.a.formItem,children:Object(a.jsx)("div",{children:p&&Object(a.jsx)(Ee,{duration:p,setDuration:P})})}),Object(a.jsx)("div",{className:Se.a.formItem,children:Object(a.jsx)(Ye,{actors:C,setActors:$})}),Object(a.jsx)("div",{children:Object(a.jsxs)("div",{className:Se.a.actionButtons,children:[Object(a.jsx)("div",{className:Se.a.actionButton,children:Object(a.jsx)(G.a,{variant:"outlined",color:"primary",onClick:function(){var e,n=[];(0===s.length&&n.push("Movie name should not be empty."),(!p||p<=0)&&n.push("Movie duration should be positive."),b.isValid()||n.push("Movie release date is not correct."),n.length>0)?B(n):I(String(null===t||void 0===t||null===(e=t.getMovie)||void 0===e?void 0:e.id),s,b,null!==p&&void 0!==p?p:0,C).then((function(){U()})).catch((function(e){return B([e.message])}))},children:"Edit Movie"})}),Object(a.jsx)("div",{className:Se.a.actionButton,children:Object(a.jsx)(G.a,{variant:"outlined",color:"default",onClick:U,children:"Back to movie details"})})]})})]})})},bn=function(){var e=function(){var e=J(),n=Object(d.a)(e,1)[0];return new l.ApolloClient({link:je(n),cache:be})}();return Object(a.jsx)(l.ApolloProvider,{client:e,children:Object(a.jsx)(p.a,{basename:"/movie-library-ui",children:Object(a.jsxs)("div",{className:u.a.appContainer,children:[Object(a.jsx)(De,{}),Object(a.jsxs)(f.c,{children:[Object(a.jsx)(f.a,{exact:!0,path:"/",component:H}),Object(a.jsx)(f.a,{exact:!0,path:"/sign-in",component:te}),Object(a.jsx)(f.a,{exact:!0,path:"/register",component:ie}),Object(a.jsx)(f.a,{exact:!0,path:"/add-movie",component:Ke}),Object(a.jsx)(f.a,{path:"/movies/:movieId",render:function(e){return function(e){return Object(a.jsx)(ln,{selectedMovieId:e.match.params.movieId})}(e)}}),Object(a.jsx)(f.a,{path:"/edit-movie/:movieId",render:function(e){return function(e){return Object(a.jsx)(vn,{selectedMovieId:e.match.params.movieId})}(e)}}),Object(a.jsx)(f.a,{path:"*",render:function(){return Object(a.jsx)(se,{text:"404 Not Found"})}})]})]})})})},mn=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,260)).then((function(n){var t=n.getCLS,a=n.getFID,r=n.getFCP,i=n.getLCP,o=n.getTTFB;t(e),a(e),r(e),i(e),o(e)}))},On=t(251);c.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(On.a,{children:Object(a.jsx)(bn,{})})}),document.getElementById("root")),mn()},26:function(e,n,t){e.exports={mainContainer:"MovieInput_mainContainer__kBMeJ",formContainer:"MovieInput_formContainer__rPvP3",formItem:"MovieInput_formItem__30MsB",actionButtons:"MovieInput_actionButtons__25wgY",actionButton:"MovieInput_actionButton__1iUwx"}},37:function(e,n,t){e.exports={mainContainer:"UserManagement_mainContainer__1GHGo",registerHint:"UserManagement_registerHint__2aWz8",formContainer:"UserManagement_formContainer__2ZMmQ",formItem:"UserManagement_formItem__205wM"}},50:function(e,n,t){e.exports={mainContainer:"MovieDisplay_mainContainer__12AI2",detailsContainer:"MovieDisplay_detailsContainer__2ZDU-",actionButtons:"MovieDisplay_actionButtons__RcfPs",actionButton:"MovieDisplay_actionButton__3ZO84",detailsInfoContainer:"MovieDisplay_detailsInfoContainer__3WtPy",inputFormItem:"MovieDisplay_inputFormItem__26umc",comments:"MovieDisplay_comments__Lvz3F",rateInput:"MovieDisplay_rateInput__2aQiH"}},84:function(e,n,t){e.exports={dashboardContainer:"MainDashboard_dashboardContainer__sT_Dq",dataGridContainer:"MainDashboard_dataGridContainer__1S24S",infoDialog:"MainDashboard_infoDialog__uXiJb",actorsCell:"MainDashboard_actorsCell__3Ejhr"}}},[[197,1,2]]]);
//# sourceMappingURL=main.451a65a7.chunk.js.map